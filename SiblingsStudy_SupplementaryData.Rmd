---
title: "SiblingsStudy_SupplementaryData"
author: "Catherine Laing & Elika Bergelson"
date: "13/02/2020"
output:
  html_document: default
  pdf_document: default
---

Need to remove subj 738 from data 

```{r setup, include = FALSE}
library(tidyverse)
library(dplyr)
library(tibble)
library(lmerTest)
library(afex)

source("DataGathering.R")
```

## Correlations with maternal factors

There were no correlations between sibling number or child word production and maternal age/education.

```{r age_mom-Sibling correlation, echo=TRUE, message=TRUE, warning=FALSE}

# Maternal age and number of siblings

cor.age <- cor.test(
  x = subset(SiblingsData, month == 18)$Siblings18
  , y = subset(SiblingsData, month == 18)$age_mom
  , method = "spearman"
)

cor.age

# Maternal education and number of siblings

cor.edu <- cor.test(
  x = subset(SiblingsData, month == 18)$Siblings18
  , y = subset(SiblingsData, month == 18)$MOTedulevel
  , method = "spearman"
)

cor.edu

# Maternal education and infant vocabulary at 18 months

cor.edu.vocab <- cor.test(
  x = subset(SiblingsData, month == 18)$Total.words
  , y = subset(SiblingsData, month == 18)$MOTedulevel
  , method = "spearman"
)

cor.edu.vocab

# Maternal age and infant vocabulary at 18 months

cor.age.vocab <- cor.test(
  x = subset(SiblingsData, month == 18)$Total.words
  , y = subset(SiblingsData, month == 18)$age_mom
  , method = "spearman"
)

cor.age.vocab

```


```{r input correlations, echo=TRUE, message=TRUE, warning=FALSE}

# Maternal input and maternal education

cor.edu.input <- cor.test(
  x = subset(speaker.type, month == 17 & speaker == "MOT" & audio_video == "video")$n
  , y = subset(speaker.type, month == 17 & speaker == "MOT" & audio_video == "video")$MOTedulevel
  , method = "spearman"
)

cor.edu.input

# Maternal input and child vocabulary

cor.vocab.input <- cor.test(
  x = subset(speaker.type, month == 17 & speaker == "MOT" & audio_video == "video")$Total.words
  , y = subset(speaker.type, month == 17 & speaker == "MOT" & audio_video == "video")$n
  , method = "spearman"
)

cor.vocab.input  # p<.05

# Maternal age and child vocabulary

cor.age.input<- cor.test(
  x = subset(speaker.type, month == 17 & speaker == "MOT" & audio_video == "video")$n
  , y = subset(speaker.type, month == 17 & speaker == "MOT" & audio_video == "video")$age_mom
  , method = "spearman"
)

cor.age.input

```

## Effect of siblings on infants' input - audio recordings

### Parental Input

```{r speaker.type model audio, message=FALSE, warning=FALSE}

#shapiro.test(speaker.type$n) # not normal

speaker.type.model_audio <- lmerTest::lmer(Log.n ~ SibGroup + Speaker + (1|subj), data=subset(speaker.type, audio_video == "audio" & 
                                                                                           Speaker != "Family.input"), REML=FALSE)
speaker.type.model.null_audio <- lmerTest::lmer(Log.n ~ Speaker + (1|subj), data=subset(speaker.type, audio_video == "audio" & 
                                                                                           Speaker != "Family.input"), REML=FALSE)

anova(speaker.type.model_audio, speaker.type.model.null_audio) # p<.001

speaker.type.mean_audio <- speaker.type %>% 
  filter(audio_video == "audio" & Speaker == "Family.input") %>%
  group_by(subj) %>% 
  mutate(MeanN = mean(n)) %>% 
  filter(month == 17) 

wilcox.test(
  x = subset(speaker.type.mean_audio, SibGroup == "None" & audio_video == "audio")$MeanN
  , y = subset(speaker.type.mean_audio, SibGroup == "One"  & audio_video == "audio")$MeanN
  , paired = FALSE
)

wilcox.test(
  x = subset(speaker.type.mean_audio, SibGroup == "2+" & audio_video == "audio")$MeanN
  , y = subset(speaker.type.mean_audio, SibGroup == "One" & audio_video == "audio")$MeanN
  , paired = FALSE
)


```

```{r Sibling input audio, message=FALSE, warning=FALSE}

# Difference in amount of input from siblings

speaker.type.SIB_audio <- speaker.type %>% group_by(subj) %>% 
  filter(Speaker == "SIBLING" & audio_video == "audio") %>%
  mutate(MeanN = mean(n),
         TotalN = sum(n)) %>%
  filter(month == 17)

wilcox.test(
  x = subset(speaker.type.SIB_audio, SibGroup == "2+")$MeanN
  , y = subset(speaker.type.SIB_audio, SibGroup == "One")$MeanN
  , paired = FALSE
) # NS


# Difference in amount of input from mothers

speaker.type.MOT_audio <- speaker.type %>% group_by(subj) %>% 
  filter(Speaker == "MOT" & audio_video == "video") %>%
  mutate(MeanN = mean(n))  %>%
  filter(month == 17)

wilcox.test(
  x = subset(speaker.type.MOT_audio, SibGroup == "None")$MeanN
  , y = subset(speaker.type.MOT_audio, SibGroup == "One")$MeanN
  , paired = FALSE
) # NS

wilcox.test(
  x = subset(speaker.type.MOT_audio, SibGroup == "2+")$MeanN
  , y = subset(speaker.type.MOT_audio, SibGroup == "One")$MeanN
  , paired = FALSE
) # p<.001

```

### Object presence

```{r Object.presence summary}

object.presence.summary_audio <- object.presence %>%
  filter(audio_video == "audio") %>%
  group_by(subj, SibGroup) %>%
  summarise(mean.object = mean(PC),
            sd.object = sd(PC),
            med.object = median(PC))

```

```{r object.presence model audio}

object.presence.model_audio <- lmerTest::lmer(PC ~ SibGroup + month + (1|subj), data=subset(object.presence, audio_video == "audio"), REML=FALSE)
object.presence.model.null_audio <- lmerTest::lmer(PC ~ month + (1|subj), data=subset(object.presence, audio_video == "audio"), REML=FALSE)
anova(object.presence.model_audio, object.presence.model.null_audio) # p<.001

# Posthoc tests

wilcox.test(
  x = subset(object.presence.summary_audio, SibGroup == "None")$mean.object
  , y = subset(object.presence.summary_audio, SibGroup == "One")$mean.object
  , paired = FALSE
) # p<.05

wilcox.test(
  x = subset(object.presence.summary_audio, SibGroup == "2+")$mean.object
  , y = subset(object.presence.summary_audio, SibGroup == "One")$mean.object
  , paired = FALSE
) # p<.01

```

# Discrete sibling  number


```{r Overall vocab: Discrete sibling number}

# Sibling number: Does number of siblings affect language development over time?

sibnumber.model <- lmerTest::lmer(Log.Totalwords ~ Siblings6 + month + (1|subj), data=SiblingsData, REML=FALSE)
sibnumber.model.null <- lmerTest::lmer(Log.Totalwords ~ month + (1|subj), data=SiblingsData, REML=FALSE)
anova(sibnumber.model, sibnumber.model.null) # significant

# summary(sibnumber.model) # for each increasing sibling, infants know 30% fewer words at 18m

```

### Parental Input

```{r speaker.type model discrete sibs, message=FALSE, warning=FALSE}

speaker.type.model_siblings <- lmerTest::lmer(Log.n ~ Siblings6 + month + sex + (1|subj), 
                                              data=subset(speaker.type, audio_video == "video"), REML=FALSE)

speaker.type.model.null_siblings <- lmerTest::lmer(Log.n ~ month + sex + (1|subj), 
                                                   data=subset(speaker.type, audio_video == "video"), REML=FALSE)

anova(speaker.type.model_siblings, speaker.type.model.null_siblings) # ns

```

### Object presence

```{r Object.presence summary discrete sibs}

object.presence.summary_siblings <- object.presence %>%
  filter(audio_video == "video") %>%
  group_by(subj, Siblings6) %>%
  summarise(mean.object = mean(PC),
            sd.object = sd(PC),
            med.object = median(PC))

```

```{r object.presence model discrete sibs}

object.presence.model_siblings <- lmerTest::lmer(PC ~ Siblings6 + month + (1|subj), 
                                                 data=subset(object.presence, audio_video == "video"), REML=FALSE)

object.presence.model.null_siblings <- lmerTest::lmer(PC ~ month + (1|subj), 
                                                      data=subset(object.presence, audio_video == "video"), REML=FALSE)

anova(object.presence.model_siblings, object.presence.model.null_siblings) # p<.001

# Posthoc tests

wilcox.test(
  x = subset(object.presence.summary_siblings, Siblings6 == "0")$mean.object
  , y = subset(object.presence.summary_siblings, Siblings6 == "1")$mean.object
  , paired = FALSE
) # p<.001

wilcox.test(
  x = subset(object.presence.summary_siblings, Siblings6 == "2")$mean.object
  , y = subset(object.presence.summary_siblings, Siblings6 == "1")$mean.object
  , paired = FALSE
) # p<.05

wilcox.test(
  x = subset(object.presence.summary_siblings, Siblings6 == "2")$mean.object
  , y = subset(object.presence.summary_siblings, Siblings6 == "3")$mean.object
  , paired = FALSE
) # NS

wilcox.test(
  x = subset(object.presence.summary_siblings, Siblings6 == "3")$mean.object
  , y = subset(object.presence.summary_siblings, Siblings6 == "4")$mean.object
  , paired = FALSE
) # NS

```
